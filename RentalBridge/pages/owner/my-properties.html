<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Properties - Rental Bridge</title>
    <link rel="stylesheet" href="../../assets/css/variables.css">
    <link rel="stylesheet" href="../../assets/css/global.css">
    <link rel="stylesheet" href="../../assets/css/navbar.css">
    <link rel="stylesheet" href="../../assets/css/footer.css">
    <link rel="stylesheet" href="../../assets/css/cards.css">
    <link rel="stylesheet" href="../../assets/css/responsive.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
    /* Fixed My Properties Page Styles */

body {
    background: #1a1a1a;
    color: white;
    padding-top: var(--navbar-height);
}

.properties-container {
    max-width: 1400px;
    margin: 0 auto;
    padding: var(--space-8) var(--space-4);
}

.page-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-6);
    flex-wrap: wrap;
    gap: var(--space-4);
}

.page-header h1 {
    font-size: var(--text-3xl);
    color: white;
    margin: 0;
}

/* Filters with dark theme */
.filters {
    display: flex;
    gap: var(--space-3);
    margin-bottom: var(--space-6);
    flex-wrap: wrap;
}

.filter-btn {
    padding: var(--space-2) var(--space-4);
    border: 1px solid rgba(255, 255, 255, 0.2);
    background: rgba(255, 255, 255, 0.05);
    color: rgba(216, 167, 32, 0.959);
    border-radius: var(--radius-lg);
    cursor: pointer;
    transition: all 0.3s;
    font-weight: 500;
}

.filter-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    border-color: rgba(255, 255, 255, 0.3);
}

.filter-btn.active {
    background: var(--accent-color);
    color: rgb(229, 194, 39);
    border-color: var(--accent-color);
}

/* Property Grid */
.properties-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: var(--space-6);
}

/* Property Card with dark theme */
.property-card {
    background: #2d2d2d;
    border-radius: var(--radius-xl);
    overflow: hidden;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    transition: transform 0.3s, box-shadow 0.3s;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.property-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.5);
    border-color: rgba(255, 255, 255, 0.2);
}

.property-img {
    width: 100%;
    height: 220px;
    object-fit: cover;
}

.property-content {
    padding: var(--space-5);
}

.property-title {
    font-size: var(--text-lg);
    font-weight: var(--font-semibold);
    margin-bottom: var(--space-2);
    color: white;
    line-height: 1.4;
}

.property-price {
    font-size: var(--text-2xl);
    color: var(--accent-color);
    font-weight: var(--font-bold);
    margin-bottom: var(--space-3);
}

.property-meta {
    display: flex;
    gap: var(--space-4);
    color: rgba(255, 255, 255, 0.6);
    font-size: var(--text-sm);
    margin-bottom: var(--space-3);
    padding-bottom: var(--space-3);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.property-meta span {
    display: flex;
    align-items: center;
    gap: var(--space-1);
}

.property-meta i {
    color: var(--accent-color);
}

.property-status {
    display: inline-block;
    padding: 6px 14px;
    border-radius: var(--radius-full);
    font-size: var(--text-xs);
    font-weight: 600;
    text-transform: capitalize;
    margin-bottom: var(--space-4);
}

.status-active {
    background: rgba(16, 185, 129, 0.2);
    color: #10b981;
    border: 1px solid rgba(16, 185, 129, 0.3);
}

.status-pending {
    background: rgba(245, 158, 11, 0.2);
    color: #f59e0b;
    border: 1px solid rgba(245, 158, 11, 0.3);
}

.status-inactive {
    background: rgba(156, 163, 175, 0.2);
    color: #9ca3af;
    border: 1px solid rgba(156, 163, 175, 0.3);
}

.property-actions {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-3);
    margin-top: var(--space-4);
}

.btn-edit,
.btn-delete {
    padding: var(--space-3);
    border: none;
    border-radius: var(--radius-md);
    cursor: pointer;
    font-size: var(--text-sm);
    font-weight: 600;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-2);
}

.btn-edit {
    background: var(--primary-color);
    color: white;
}

.btn-edit:hover {
    background: var(--primary-dark);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(37, 99, 235, 0.4);
}

.btn-delete {
    background: rgba(239, 68, 68, 0.2);
    color: #ef4444;
    border: 1px solid rgba(239, 68, 68, 0.3);
}

.btn-delete:hover {
    background: #ef4444;
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(239, 68, 68, 0.4);
}

/* Empty State */
.empty-state {
    text-align: center;
    padding: var(--space-16) var(--space-4);
    color: rgba(255, 255, 255, 0.6);
}

.empty-state i {
    font-size: 80px;
    color: rgba(255, 255, 255, 0.2);
    margin-bottom: var(--space-4);
}

.empty-state h3 {
    font-size: var(--text-xl);
    color: white;
    margin-bottom: var(--space-2);
}

.empty-state p {
    color: rgba(255, 255, 255, 0.5);
    margin-bottom: var(--space-6);
}

/* Add Property Button */
.btn.btn-primary {
    background: var(--accent-color);
    color: white;
    padding: var(--space-3) var(--space-6);
    border-radius: var(--radius-md);
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    font-weight: 600;
    transition: all 0.3s;
    border: none;
    cursor: pointer;
}

.btn.btn-primary:hover {
    background: var(--accent-dark);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(245, 158, 11, 0.4);
}

.btn.btn-primary i {
    font-size: var(--text-base);
}

/* Responsive Design */
@media (max-width: 768px) {
    .properties-grid {
        grid-template-columns: 1fr;
    }
    
    .page-header {
        flex-direction: column;
        align-items: flex-start;
    }
    
    .btn.btn-primary {
        width: 100%;
        justify-content: center;
    }
    
    .filters {
        width: 100%;
        justify-content: flex-start;
    }
    
    .property-actions {
        grid-template-columns: 1fr;
    }
}

@media (max-width: 480px) {
    .property-meta {
        flex-wrap: wrap;
        gap: var(--space-2);
    }
}
</style>
</head>
<body>
    <div id="navbar-container"></div>
    <main class="properties-container">
        <div class="page-header">
            <h1>My Properties (<span id="propertyCount">0</span>)</h1>
            <a href="add-property.html" class="btn btn-primary">
                <i class="fas fa-plus"></i> Add New Property
            </a>
        </div>
        <div class="filters">
            <button class="filter-btn active" data-filter="all">All</button>
            <button class="filter-btn" data-filter="active">Active</button>
            <button class="filter-btn" data-filter="pending">Pending</button>
            <button class="filter-btn" data-filter="inactive">Inactive</button>
        </div>
        <div class="properties-grid" id="propertiesGrid"></div>
    </main>
    <div id="footer-container"></div>
    <script src="../../assets/js/storage.js"></script>
    <script src="../../assets/js/auth.js"></script>
    <script src="../../assets/js/properties.js"></script>
    <script src="../../assets/js/owner.js"></script>
    <script src="../../assets/js/utils.js"></script>
    <script src="../../assets/js/main.js"></script>
    <script>
        let currentFilter='all';
        document.addEventListener('DOMContentLoaded',async()=>{
            await loadComponent('navbar-container','../../components/navbar.html');
            await loadComponent('footer-container','../../components/footer.html');
            checkOwnerAuth();
            loadProperties();
            document.querySelectorAll('.filter-btn').forEach(btn=>{
                btn.addEventListener('click',e=>{
                    document.querySelectorAll('.filter-btn').forEach(b=>b.classList.remove('active'));
                    e.target.classList.add('active');
                    currentFilter=e.target.dataset.filter;
                    loadProperties();
                });
            });
        });
        function loadProperties(){
            const properties=getOwnerProperties();
            const filtered=currentFilter==='all'?properties:properties.filter(p=>p.status===currentFilter);
            document.getElementById('propertyCount').textContent=filtered.length;
            const grid=document.getElementById('propertiesGrid');
            if(filtered.length===0){
                grid.innerHTML=`<div class="empty-state" style="grid-column:1/-1">
                    <i class="fas fa-home"></i>
                    <h3>No Properties Found</h3>
                    <p>Start by adding your first property</p>
                    <a href="add-property.html" class="btn btn-primary">Add Property</a>
                </div>`;
                return;
            }
            grid.innerHTML=filtered.map(p=>`
                <div class="property-card">
                    <img src="${p.images?.[0]||'../../assets/images/placeholder.jpg'}" alt="${p.title}" class="property-img">
                    <div class="property-content">
                        <h3 class="property-title">${p.title}</h3>
                        <div class="property-price">â‚¹${p.price.toLocaleString()}/mo</div>
                        <div class="property-meta">
                            <span><i class="fas fa-bed"></i> ${p.bedrooms}</span>
                            <span><i class="fas fa-bath"></i> ${p.bathrooms}</span>
                            <span><i class="fas fa-ruler"></i> ${p.area} sqft</span>
                        </div>
                        <span class="property-status status-${p.status}">${p.status}</span>
                        <div class="property-actions">
                            <button class="btn-edit" onclick="editProperty('${p.id}')">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="btn-delete" onclick="deleteProperty('${p.id}')">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        function editProperty(id){
            window.location.href=`add-property.html?id=${id}`;
        }
        function deleteProperty(id){
            if(confirm('Are you sure you want to delete this property?')){
                const properties=getOwnerProperties().filter(p=>p.id!==id);
                const currentUser=getCurrentUser();
                localStorage.setItem(`properties_${currentUser.id}`,JSON.stringify(properties));
                showNotification('Property deleted successfully','success');
                loadProperties();
            }
        }
    </script>
</body>
</html>